#!/bin/bash
set -eo pipefail

echo "---> Python 3.7 Buildpack"

LAYERS_DIR="$1"
PYTHON37_LAYER="$LAYERS_DIR/python37"
# We split the cache into a separate layer that isn't used at runtime
APTCACHE_LAYER="$LAYERS_DIR/apt"

mkdir -p "$PYTHON37_LAYER" "$APTCACHE_LAYER"

echo "----> Installing python3.7"
echo "python3 python3-dev" > "$PYTHON37_LAYER/Aptfile"

/usr/bin/install-packages "$PYTHON37_LAYER" "$APTCACHE_LAYER"

cat > "$PYTHON37_LAYER.toml" <<TOML
launch = true
cache = true
build = true
TOML

cat > "$APTCACHE_LAYER.toml" <<TOML
cache = true
build = true
TOML

